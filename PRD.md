## 產品需求文件 (PRD): 台灣電影資訊整合平台 (V1)

**文件版本:** 1.2
**日期:** 2025年11月4日
**產品負責人:** SQ

### 1. 🚀 產品願景 (Vision)

打造一個一站式（One-Stop）的電影資訊整合平台，提供最快、最準確的全台電影場次搜尋服務，解決使用者必須在多個影城網站間切換的痛點。

### 2. 🎯 產品目標 (Goals)

* **V1 目標：** 成為使用者搜尋「特定電影場次」或「特定電影院時刻表」的首選工具，並提供完整的資訊閉環（從搜尋、決策到導向官方訂票）。

### 3. 👥 目標使用者 (Target Audience)

1.  **目標導向型:** "我想看《沙丘 3》，幫我找到信義區所有影城的 IMAX 場次。"
2.  **地點導向型:** "我 30 分鐘後會到板橋車站，想知道板橋威秀或秀泰有什麼電影快開演了。"
3.  **LBS 探索型:** "我現在有空，想看個電影，我附近有哪些電影院？"

### 4. 🌟 V1 核心功能 (Core Features)

根據我們的討論，V1 將專注於提供一個無縫的「搜尋-決策-行動」體驗。

#### F1.1: 跨影城電影場次搜尋
* **使用者故事：** 身為使用者，我想要搜尋一部電影的名稱，以便我能看到全台灣（或特定區域）所有上映這部電影的影城、時間與影廳資訊。
* **驗收標準 (AC):**
    * 首頁提供一個主搜尋框，支援輸入電影中/英文名稱。
    * 搜尋結果頁整合「所有目標連鎖影城」的資料。
    * 結果列表需清楚顯示：[電影院名稱]、[地址]、[放映時間]、[語言版本]、[影廳類型]。
    * 使用者可以切換日期（預設今天，可看未來 3-5 天）。

#### F1.2: 特定電影院時刻表查詢
* **使用者故事：** 身為使用者，我想要選擇或搜尋一間特定的電影院，以便我能瀏覽該影城當日（或未來幾天）所有上映的電影與時刻表。
* **驗收標準 (AC):**
    * 提供「依地區」（如：台北市 -> 信義區）或「依影城品牌」（如：威秀）的瀏覽方式。
    * 電影院專屬頁面，清楚列出該影城上映的「所有電影」及其「所有場次時間」。

#### F1.3: 附近電影院 LBS 搜尋
* **使用者故事：** 身為使用者，我想要授權我的位置，以便我能立即看到離我最近的電影院列表，並依距離排序。
* **驗收標準 (AC):**
    * 首頁提供「搜尋附近電影院」按鈕 (CTA)。
    * 點擊後觸發瀏覽器定位授權。
    * 授權成功後，顯示電影院列表（或地圖視圖），標示距離。
    * 點擊列表中的任一電影院，應導向 F1.2 (該影城的時刻表頁面)。

#### F1.4: 電影詳細資訊頁
* **使用者故事：** 身為使用者，我想要在搜尋結果或時刻表上點擊一部電影，以便我能查看該電影的詳細資訊，幫助我決定是否觀看。
* **驗收標準 (AC):**
    * 電影詳情頁應包含：電影海報、劇情簡介、導演/演員、片長、電影分級。
    * （加分項）嵌入 YouTube 預告片。
    * （加分項）顯示外部評分（如 IMDb / 爛番茄），增加決策依據。
    * 此頁面下方應直接顯示該電影的「所有場次列表」（同 F1.1 的結果）。

#### F1.5: 場次快速篩選器
* **使用者故事：** 身為使用者，當我看到 F1.1 (依電影搜尋) 或 F1.2 (依影城搜尋) 的場次列表時，我想要快速篩選結果。
* **驗收標準 (AC):**
    * 在場次列表上方，應提供至少以下篩選器：
        * **時段：** 早場 (12:00前)、下午 (12:00-18:00)、晚上 (18:00-22:00)、午夜場 (22:00後)。
        * **影廳類型：** IMAX, 4DX, Dolby, 一般廳等（依爬取到的資料動態產生）。
        * **語言版本：** 中文版、英語版等。

#### F1.6: 官網訂票快速連結 (Link-out)
* **使用者故事：** 身為使用者，當我找到一個想看的完美場次後，我想要點擊一個按鈕，以便我能被導向到該影城（如：威秀）的官方網站進行訂票。
* **驗收標準 (AC):**
    * 在每一個「場次時間」旁，都應有一個清晰的「官網訂票」按鈕。
    * 點擊該按鈕後，應在新分頁開啟該影城的官方網站。
    * （加分項/優化目標）如果可能，盡力讓連結導向到「已選定該電影」的訂票頁面，減少使用者在官網還需重新搜尋的步驟。

---

### 5. 🛠️ 技術與非功能性需求

#### 5.1 資料更新 (Data Freshness)
* **範圍：** V1 鎖定台灣主要的連鎖影城（例如：威秀、國賓、新光、秀泰等）。
* **機制：** 執行每日排程爬蟲 (Daily Cron Job)。
* **時間：** 每日凌晨 00:00 啟動，抓取「未來 3-5 天」的場次資料。（V1 可接受最高 24 小時的資料延遲）。
* **監控：** 必須建立爬蟲監控機制。當目標網站 HTML 結構變更導致爬蟲解析 (Parsing) 失敗時，應能發出告警（例如：透過 Email 或 Slack）。

#### 5.2 平台 (Platform)
* **類型：** RWD (響應式網頁設計)，確保在手機、平板、電腦上皆有良好瀏覽體驗。

#### 5.3 效能 (Performance)
* **核心搜尋：** 搜尋場次的回應時間 (Time to First Byte) 應在 2 秒內。
* **LBS：** 定位及顯示附近影院列表應在 3 秒內完成。

#### 5.4 法律與風險
* **爬蟲禮儀：** 遵守已檢查過的 `robots.txt` 規範。爬蟲應設置合理的 `User-Agent` 並控制請求頻率 (Rate Limit)，避免造成對方伺服器負擔。

---

### 6. 💡 建議技術架構 (V1 Tech Stack)

#### A. 前端 (Frontend) - RWD 網站
* **框架 (Framework):** **Next.js (React)** 或 **Nuxt.js (Vue.js)**
* **為什麼？**
    * 這兩者都是 RWD 的首選。
    * 它們支援 **SSR (Server-Side Rendering)** 或 **SSG (Static Site Generation)**。
    * **關鍵優勢：** 我們可以在爬蟲更新資料後，為「電影院頁面」、「電影詳情頁」預先生成靜態頁面 (SSG)，這將提供極致的載入速度，並對 **SEO (搜尋引擎優化)** 非常友好。當使用者搜尋「信義威秀 時刻表」時，你的網站有機會排在 Google 搜尋結果前列。
* **部署 (Deployment):** **Vercel** (與 Next.js 完美整合) 或 Netlify。

#### B. 後端 (Backend) - API 伺服器
* **框架 (Framework):** **FastAPI (Python)**
* **為什麼？**
    * 基於 Python（與你的爬蟲語言一致）。
    * **極高效能：** 如其名，效能逼近 NodeJS。
    * **開發快速：** 自動生成 API 文件 (Swagger UI)，非常適合 Side Project 快速迭代。
    * **強大生態系：** 可與 Pydantic 結合，確保資料驗證。
* **替代方案：** Flask (輕量) 或 Django (重量級，但內建功能多)。

#### C. 資料庫 (Database)
* **類型:** **PostgreSQL**
* **為什麼？**
    * 穩定、強大且開源的關聯式資料庫 (RDBMS)。
    * 非常適合儲存結構化的「場次」資料（影城、電影、時間之間的關聯）。
    * (未來擴展) 支援 **PostGIS** 套件，若 V2 想做更複雜的「地理位置」運算（例如：計算 3 公里範圍內的所有場次）時非常有用。

#### D. 爬蟲與排程 (Scraper & Scheduler)
* **爬蟲核心 (Scraping):** **Scrapy (Python)** 或 **BeautifulSoup + httpx (Python)**
    * **Scrapy:** 完整的爬蟲「框架」，功能強大，內建異步、Pipeline、錯誤處理。適合複雜、大規模的爬取。
    * **BS4+httpx:** 輕量級「函式庫」，適合 V1 目標影城不多、結構較單純的情況，開發更快速。`httpx` 支援異步 (async) 請求。
* **排程 (Scheduling):** **Celery (Python)**
    * **為什麼？** 強大且穩定的分散式任務佇列 (Task Queue)。
    * **架構：** 搭配 **Redis** 或 RabbitMQ 作為 Broker。
    * **優勢：** 不僅能處理「每日 00:00」的排程任務 (Cron Job)，未來若要增加「每 4 小時更新一次」或「爬蟲失敗自動重試」等複雜邏輯，Celery 都能完美支援。
* **簡易替代方案：** 如果 V1 部署在單一主機 (VM)，可以直接使用 Linux 的 `crontab` 來定時執行 Python 爬蟲腳本。

#### E. 快取 (Caching) - 建議
* **工具:** **Redis**
* **為什麼？**
    * 「熱門電影」（如：沙丘 3）和「熱門影城」（如：信義威秀）的搜尋請求會非常頻繁。
    * 將這些熱門搜尋結果緩存在 Redis 中（例如：設定 1 小時過期），可以大幅降低資料庫負擔，並讓 API 回應近乎即時。
    * Redis 也可以作為 Celery 的 Broker，一舉兩得。

#### F. 整合部署 (Deployment)
* **方案：** **Docker + Docker Compose**
* **為什麼？** 將 Frontend (Next.js)、Backend (FastAPI)、Database (PostgreSQL)、Scheduler (Celery)、Cache (Redis) 各自打包成一個容器 (Container)。
* **優勢：**
    1.  **環境一致性：** 解決「在我的電腦上可以跑」的問題。
    2.  **易於部署：** 一鍵啟動 ( `docker-compose up` ) 所有服務。
    3.  **平台無關：** 可以輕鬆部署到任何雲平台，如 GCP (Cloud Run, GKE)、AWS (ECS) 或 DigitalOcean。

---

### 7. 📈 成功指標 (Success Metrics)

* **V1 核心指標：** **任務完成率 (Task Success Rate)**
    * (計算方式：點擊「官網訂票」連結的次數 / 執行「搜尋」的總次數)
    * (目標：驗證我們是否成功打造了「搜尋-決策-行動」的閉環)
* **使用者黏著度：** 每日/每月活躍使用者 (DAU/MAU)。
* **功能採用率：** LBS (F1.3) 功能的使用百分比。

---

### 8. 🚀 未來擴展 (Future Scope / V2+)

V1 專注於工具性，V2 及 V3 將導入社群、體驗與創新功能，建立護城河。

#### V2 階段：優化與個人化
* **V2.1 (個人化):** 使用者帳號、收藏最愛電影院、追蹤待看清單。
* **V2.2 (殺手級功能):** 整合「票價」與「信用卡優惠」資訊，提供比價功能。
* **V2.3 (社群):** 設有討論區，並且每部電影可以留評論及星星評分，該部電影的評分會從所有評論中取平均。
* **V2.4 (推播):** 「即將上映」通知、「開放訂票」推播。

#### V3 階段：創新與社群深化
* **V3.1 (社交創新): 朋友揪團工具**
    * 解決朋友間「要看什麼？」、「何時有空？」的溝通困境。
    * 提供電影/時間投票、自動推薦最佳共同場次、一鍵分享結果。
    * 目的：透過社交分享驅動病毒式成長。

* **V3.2 (內容策展): 主題片單與特別放映**
    * 整合編輯、KOL 策展的「主題片單」（如：約會電影、燒腦片單）。
    * 聚合獨立影院、影展、經典重映等「特別放映」資訊。
    * 目的：吸引核心影迷 (Cinephile) 群體。

* **V3.3 (深度社群): 安全的「揪伴觀影」機制 (新功能)**
    * **定位：** 嚴格專注於「尋找電影同好」，**明確區隔**於「交友配對 (Dating)」。
    * **核心優化：**
        * **(A) 公開揪團模式：** 以「多對多」的公開揪團（例如：沙丘 3 鐵粉團 1/5 人）取代高風險的「1v1 陌生配對」。使用者只能搜尋或加入「特定場次」的公開團。
        * **(B) 觀影檔案 (Movie Persona)：** 使用者檔案頁**僅**顯示觀影相關資訊，如：偏好類型、常出沒影城、觀影習慣標籤（如：`#安靜觀影`、`#映後愛討論`、`#必吃爆米花`），**禁止**放置身高、體重、職業等敏感交友資訊。
        * **(C) 強制安全機制：** 發起或加入揪團前，必須完成「手機實名驗證」。
        * **(D) 雙向評價系統：** 活動結束後，參與者（含主揪）需匿名互評「觀影禮儀」、「準時性」、「友善度」。此「信任分數」將作為未來參與的依據。
        * **(E) 檢舉與黑名單：** 內建聊天室需提供清晰的「一鍵檢舉並封鎖」功能，防止騷擾。